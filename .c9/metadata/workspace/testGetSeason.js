{"changed":true,"filter":false,"title":"testGetSeason.js","tooltip":"/testGetSeason.js","value":"var request = require('request');\nvar cheerio = require('cheerio');\n\n/*\n * Scraper Constructor\n **/\n\nfunction seasonScraper(leagueUrl) {\n    this.init();\n    this.Urls = [];\n    this.RoundIds = [];\n    this.url = 'http://us.soccerway.com/national/england/premier-league';\n    this.CountSession = 0;\n}\n\nseasonScraper.prototype.init() = function() {\n    var that=this;\n    request(this.url, function(error, response, html) {\n\n        if (!error) {\n\n            var $ = cheerio.load(html);\n            //get all season availabll and its associated url\n            $('div#subheading div.submenu_dropdown select#season_id_selector option').each(function(i) {\n\n                var link = $(this).attr('value');\n                var season = $(this).text().trim();\n\n                var Seasons = {\n                    season: season,\n                    url: link\n                };\n\n                that.Urls.push(Seasons);\n            });\n            for (var i = 0; i < 5; i++) {\n                that.genRounId('http://us.soccerway.com/');\n            }\n        }\n        //console.log(Urls);\n    });\n};\n\nseasonScraper.prototype.getRoundId=function (num) {\n\n};\n\nseasonScraper.prototype.genRounId= function (url) {\n    var that=this;\n    if (!this.Urls.length) {\n        this.CountSession--;\n        if (this.CountSession < 2) {\n            console.log(this.RoundIds);\n        }\n        console.log('Done');\n        return;\n    }\n\n    this.CountSession++;\n    console.log(\"#genRounId \" + this.CountSession);\n    var pair = this.Urls.pop();\n    var season = pair.season;\n    var seasonUrl = url + pair.url;\n    console.log('Lefts ' + this.Urls.length);\n    //Each season page has redirect page which has it own round_id as url params\n    request(seasonUrl, function(error, response, html) {\n        if (!error) {\n            var $ = cheerio.load(html);\n            $('div.content div div form table').each(function(i, elem) {\n                if (i == 0) {\n                    //$('div.content div table.playerstats.table').each(function() {\n                    //console.log('inner');\n                    var x = $(this).attr('data-round_id');\n                    console.log(season + '  data-round_id = ' + x);\n                    var RoundId = {\n                        season: season,\n                        id: x\n                    };\n                    that.RoundIds.push(RoundId);\n                    //return false;\n                }\n                else return false; //get only fisrt element\n            });\n\n        }\n        else {\n            console.log(error);\n            that.genRounId('http://us.soccerway.com/');\n        }\n    });\n    that.genRounId('http://us.soccerway.com/');\n};\n","undoManager":{"mark":93,"position":100,"stack":[[{"group":"doc","deltas":[{"start":{"row":15,"column":25},"end":{"row":15,"column":26},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":26},"end":{"row":15,"column":27},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":27},"end":{"row":15,"column":28},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":28},"end":{"row":15,"column":30},"action":"insert","lines":["()"]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":30},"end":{"row":15,"column":31},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":31},"end":{"row":15,"column":32},"action":"insert","lines":["="]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":32},"end":{"row":15,"column":33},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":33},"end":{"row":15,"column":34},"action":"insert","lines":["F"]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":34},"end":{"row":15,"column":35},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":35},"end":{"row":15,"column":36},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":35},"end":{"row":15,"column":36},"action":"remove","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":34},"end":{"row":15,"column":35},"action":"remove","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":33},"end":{"row":15,"column":34},"action":"remove","lines":["F"]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":33},"end":{"row":15,"column":34},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":34},"end":{"row":15,"column":35},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":33},"end":{"row":15,"column":35},"action":"remove","lines":["fu"]},{"start":{"row":15,"column":33},"end":{"row":15,"column":41},"action":"insert","lines":["function"]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":41},"end":{"row":15,"column":42},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":42},"end":{"row":15,"column":44},"action":"insert","lines":["()"]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":44},"end":{"row":15,"column":45},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":45},"end":{"row":15,"column":46},"action":"insert","lines":["{"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":0},"end":{"row":16,"column":8},"action":"remove","lines":["function"]}]}],[{"group":"doc","deltas":[{"start":{"row":40,"column":3},"end":{"row":41,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":41,"column":0},"end":{"row":41,"column":1},"action":"insert","lines":["}"]}]}],[{"group":"doc","deltas":[{"start":{"row":6,"column":0},"end":{"row":6,"column":1},"action":"remove","lines":[" "]},{"start":{"row":15,"column":41},"end":{"row":15,"column":42},"action":"remove","lines":[" "]},{"start":{"row":16,"column":0},"end":{"row":17,"column":2},"action":"insert","lines":["","  "]},{"start":{"row":17,"column":3},"end":{"row":18,"column":0},"action":"remove","lines":["",""]},{"start":{"row":17,"column":3},"end":{"row":17,"column":4},"action":"insert","lines":[" "]},{"start":{"row":19,"column":0},"end":{"row":19,"column":4},"action":"insert","lines":["    "]},{"start":{"row":21,"column":8},"end":{"row":21,"column":12},"action":"insert","lines":["    "]},{"start":{"row":22,"column":0},"end":{"row":22,"column":4},"action":"insert","lines":["    "]},{"start":{"row":23,"column":0},"end":{"row":23,"column":2},"action":"insert","lines":["  "]},{"start":{"row":23,"column":10},"end":{"row":23,"column":12},"action":"insert","lines":["  "]},{"start":{"row":25,"column":12},"end":{"row":25,"column":16},"action":"insert","lines":["    "]},{"start":{"row":26,"column":0},"end":{"row":26,"column":4},"action":"insert","lines":["    "]},{"start":{"row":28,"column":12},"end":{"row":28,"column":16},"action":"insert","lines":["    "]},{"start":{"row":29,"column":0},"end":{"row":29,"column":4},"action":"insert","lines":["    "]},{"start":{"row":30,"column":0},"end":{"row":30,"column":1},"action":"insert","lines":[" "]},{"start":{"row":30,"column":17},"end":{"row":30,"column":20},"action":"insert","lines":["   "]},{"start":{"row":31,"column":12},"end":{"row":31,"column":16},"action":"insert","lines":["    "]},{"start":{"row":33,"column":0},"end":{"row":33,"column":3},"action":"insert","lines":["   "]},{"start":{"row":33,"column":15},"end":{"row":33,"column":16},"action":"insert","lines":[" "]},{"start":{"row":34,"column":0},"end":{"row":34,"column":4},"action":"insert","lines":["    "]},{"start":{"row":35,"column":8},"end":{"row":35,"column":12},"action":"insert","lines":["    "]},{"start":{"row":36,"column":0},"end":{"row":36,"column":1},"action":"insert","lines":[" "]},{"start":{"row":36,"column":13},"end":{"row":36,"column":16},"action":"insert","lines":["   "]},{"start":{"row":37,"column":8},"end":{"row":37,"column":12},"action":"insert","lines":["    "]},{"start":{"row":38,"column":0},"end":{"row":38,"column":3},"action":"insert","lines":["   "]},{"start":{"row":38,"column":7},"end":{"row":38,"column":8},"action":"insert","lines":[" "]},{"start":{"row":39,"column":0},"end":{"row":39,"column":4},"action":"insert","lines":["    "]},{"start":{"row":40,"column":0},"end":{"row":40,"column":4},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":12},"end":{"row":17,"column":13},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":13},"end":{"row":17,"column":14},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":14},"end":{"row":17,"column":15},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":15},"end":{"row":17,"column":16},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":16},"end":{"row":17,"column":17},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":0},"end":{"row":16,"column":4},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":4},"end":{"row":16,"column":5},"action":"insert","lines":["v"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":5},"end":{"row":16,"column":6},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":6},"end":{"row":16,"column":7},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":7},"end":{"row":16,"column":8},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":8},"end":{"row":16,"column":9},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":9},"end":{"row":16,"column":10},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":10},"end":{"row":16,"column":11},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":11},"end":{"row":16,"column":12},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":12},"end":{"row":16,"column":13},"action":"insert","lines":["="]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":13},"end":{"row":16,"column":14},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":14},"end":{"row":16,"column":15},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":15},"end":{"row":16,"column":16},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":16},"end":{"row":16,"column":17},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":17},"end":{"row":16,"column":18},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":8},"end":{"row":16,"column":12},"action":"remove","lines":["that"]},{"start":{"row":16,"column":8},"end":{"row":16,"column":9},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":9},"end":{"row":16,"column":10},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":9},"end":{"row":16,"column":10},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":8},"end":{"row":16,"column":9},"action":"remove","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":8},"end":{"row":16,"column":9},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":9},"end":{"row":16,"column":10},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":10},"end":{"row":16,"column":11},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":11},"end":{"row":16,"column":12},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":33,"column":16},"end":{"row":33,"column":20},"action":"insert","lines":["that"]}]}],[{"group":"doc","deltas":[{"start":{"row":33,"column":20},"end":{"row":33,"column":21},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":43,"column":0},"end":{"row":43,"column":24},"action":"insert","lines":["seasonScraper.prototype."]}]}],[{"group":"doc","deltas":[{"start":{"row":43,"column":33},"end":{"row":43,"column":43},"action":"remove","lines":["getRoundId"]}]}],[{"group":"doc","deltas":[{"start":{"row":43,"column":24},"end":{"row":43,"column":34},"action":"insert","lines":["getRoundId"]}]}],[{"group":"doc","deltas":[{"start":{"row":43,"column":34},"end":{"row":43,"column":35},"action":"insert","lines":["="]}]}],[{"group":"doc","deltas":[{"start":{"row":47,"column":0},"end":{"row":47,"column":24},"action":"insert","lines":["seasonScraper.prototype."]}]}],[{"group":"doc","deltas":[{"start":{"row":47,"column":33},"end":{"row":47,"column":42},"action":"remove","lines":["genRounId"]}]}],[{"group":"doc","deltas":[{"start":{"row":47,"column":24},"end":{"row":47,"column":33},"action":"insert","lines":["genRounId"]}]}],[{"group":"doc","deltas":[{"start":{"row":47,"column":33},"end":{"row":47,"column":34},"action":"insert","lines":["="]}]}],[{"group":"doc","deltas":[{"start":{"row":47,"column":34},"end":{"row":47,"column":35},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":0},"end":{"row":48,"column":4},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":4},"end":{"row":48,"column":5},"action":"insert","lines":["v"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":5},"end":{"row":48,"column":6},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":6},"end":{"row":48,"column":7},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":7},"end":{"row":48,"column":8},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":8},"end":{"row":48,"column":9},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":9},"end":{"row":48,"column":10},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":10},"end":{"row":48,"column":11},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":11},"end":{"row":48,"column":12},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":12},"end":{"row":48,"column":13},"action":"insert","lines":["="]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":13},"end":{"row":48,"column":14},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":14},"end":{"row":48,"column":15},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":15},"end":{"row":48,"column":16},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":16},"end":{"row":48,"column":17},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":48,"column":17},"end":{"row":48,"column":18},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":49,"column":9},"end":{"row":49,"column":13},"action":"insert","lines":["this"]}]}],[{"group":"doc","deltas":[{"start":{"row":49,"column":13},"end":{"row":49,"column":14},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":50,"column":8},"end":{"row":50,"column":13},"action":"insert","lines":["this."]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":12},"end":{"row":51,"column":17},"action":"insert","lines":["this."]}]}],[{"group":"doc","deltas":[{"start":{"row":52,"column":24},"end":{"row":52,"column":29},"action":"insert","lines":["this."]}]}],[{"group":"doc","deltas":[{"start":{"row":60,"column":15},"end":{"row":60,"column":20},"action":"insert","lines":["this."]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":27},"end":{"row":63,"column":32},"action":"insert","lines":["this."]}]}],[{"group":"doc","deltas":[{"start":{"row":68,"column":0},"end":{"row":69,"column":0},"action":"remove","lines":["            //console.log(seasonUrl);",""]}]}],[{"group":"doc","deltas":[{"start":{"row":67,"column":0},"end":{"row":68,"column":0},"action":"remove","lines":["            //console.log('season ' + season + ' genRounIdfounded');",""]}]}],[{"group":"doc","deltas":[{"start":{"row":78,"column":20},"end":{"row":78,"column":24},"action":"insert","lines":["that"]}]}],[{"group":"doc","deltas":[{"start":{"row":78,"column":24},"end":{"row":78,"column":25},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":12},"end":{"row":87,"column":17},"action":"insert","lines":["that."]}]}],[{"group":"doc","deltas":[{"start":{"row":90,"column":4},"end":{"row":90,"column":9},"action":"insert","lines":["that."]}]}],[{"group":"doc","deltas":[{"start":{"row":58,"column":4},"end":{"row":58,"column":8},"action":"insert","lines":["this"]}]}],[{"group":"doc","deltas":[{"start":{"row":58,"column":8},"end":{"row":58,"column":9},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":59,"column":32},"end":{"row":59,"column":37},"action":"insert","lines":["this."]}]}],[{"group":"doc","deltas":[{"start":{"row":41,"column":1},"end":{"row":41,"column":2},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":16},"end":{"row":36,"column":20},"action":"insert","lines":["that"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":20},"end":{"row":36,"column":21},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":0},"end":{"row":15,"column":1},"action":"remove","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":0},"end":{"row":15,"column":1},"action":"insert","lines":["S"]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":0},"end":{"row":15,"column":1},"action":"remove","lines":["S"]}]}],[{"group":"doc","deltas":[{"start":{"row":15,"column":0},"end":{"row":15,"column":1},"action":"insert","lines":["s"]}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":4,"column":22},"end":{"row":4,"column":22},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1418876129398}